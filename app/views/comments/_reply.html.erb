<% comments.each do |comment| %>  
  <div class="comments-show">
    <div class="comment">
      <p><%= comment.body %><br></p>
        <small class="text-muted">
        Commentaire il y Ã  <%= time_ago_in_words(comment.created_at) %>
        par <%= comment.user.first_name.capitalize! %> 
      </small>
      <% if current_user.id == comment.user.id %>
        <%= link_to "Delete", comment_path(comment),
                        method: :delete, data: { confirm: "Are you sure?" }, class: 'nested-form' %> 
        <div class="panel-group">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" href="#collapse<%= comment.id %>" class="nested-form">Reply</a>                            
                </h4>
            </div>
            <div id="collapse<%= comment.id %>" class="panel-collapse collapse">
              <div class="reply-form">
                <%= form_for @new_comment do |f| %>
                  <%= f.hidden_field :commentable_id, value: @new_comment.commentable_id %>
                  <%= f.hidden_field :commentable_type, value: @new_comment.commentable_type %>
                  <%= f.hidden_field :comment_id, value: comment.id %>
                  <div class="field form-group">
                    <%= f.text_area :body, class: 'form-control', required: true %>
                  </div>
                  <div class="field form-group">
                    <%= submit_tag "Post Reply", class: 'btn btn-outline-success' %>
                  </div>
                <% end %>
              </div>
            </div>
                             <hr>

            <%= render partial: "comments/reply", locals: {comments: comment.children} %>
          </div>
        <% end %>  

    </div>
  </div>
</div>


